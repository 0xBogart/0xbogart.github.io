<!DOCTYPE html>
<html lang="es">
<head>
	<title>LUKS &amp; dm-crypt | ØxBogart</title>

	<!-- meta -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0,user-scalable=no,viewport-fit=cover">
	<link rel="icon" type="/image/png" href="/blog/img/skull.png">
	<link rel="canonical" href="https://0xbogart.github.io/blog/hardening/luks">
	<meta name="author" content="Bogart">
	<meta name="keywords" content="Luks [Linux Unified Key Setup]">
	<meta name="description" content="Luks [Linux Unified Key Setup]">

	<!-- Twitter Tags -->
	<meta property="og:title" content="Luks">
	<meta property="og:description" content="Luks [Linux Unified Key Setup]">
	<meta property="og:url" content="https://0xbogart.github.io/blog/hardening/luks">
	<meta property="og:image" content="https://0xbogart.github.io/blog/img/luks-dmcrypt.avif">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@jfb0gart">
	<meta name="twitter:creator" content="@jfb0gart">
	<meta name="twitter:title" content="Luks [Linux Unified Key Setup] | ØxBogart">
	<meta name="twitter:description" content="Luks [Linux Unified Key Setup] | ØxBogart">
	<meta name="twitter:image" content="https://0xbogart.github.io/blog/img/luks-dmcrypt.avif">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

	<!-- css -->
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/ionicons.min.css">
	<link rel="stylesheet" href="/css/tabbarpurple.css">
	<link rel="stylesheet" href="/css/sidebarpurple.css">
	<link rel="stylesheet" href="/css/pace.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="stylesheet" href="/css/lithiumterm.css">

	<!-- js -->
	<script src="/js/jquery-2.1.3.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/tabbar.js"></script>
	<script src="/js/pace.min.js"></script>
	<script src="/js/modernizr.custom.js"></script>
	<script src="/js/aspurplelight.js"></script>
<style>
@media (max-width: 600px) {
  .icomax {
    min-width: 25%;
  }
}

@media (max-width: 600px) {
  .imgmax {
    min-width: 100%;
  }
}

.bg {
	border: 5px solid black;
	width: 100%;
	height: 100%;
}
</style>
</head>

<body class="bg">
	<div class="container">	
		<header id="site-header">
			<div class="row">
				<div style="margin-bottom: -10%;">
					<h1><a class="nodeco" href="/blog/hardening" style="color: rgb(194, 0, 194);">☰</a>Hardening</h1>
				</div><!-- col-4 -->
			</div>
			<div class="row justify-content-end">
				<div class="col-2" style="margin-top: 5px;">
					<nav class="navbar navbar-expand-lg navbar-light">
						<button style="border: 1px solid rgb(194, 0, 194);" class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#bs-example-navbar-collapse-1" aria-controls="bs-example-navbar-collapse-1" aria-expanded="false" aria-label="Toggle navigation">
							<span class="navbar-toggler-icon"></span>
						</button>
						<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
							<ul class="navbar-nav">
								<li class="nav-item">
									<a style="font-size: 25px;" class="nav-link" href="/index" data-hover="Home">Home</a>
								</li>
							</ul>
						</div><!--- .navbar-collapse --->
					</nav>
				</div><!-- col-md-8 -->
			</div>
		</header>
	</div>

	<!-- TABBAR -->
	<div style="position: sticky; top: -1px; width: auto;">
		<a onclick="toggleDropdown()">
			<div class="tabbar">
				<span style="font-weight: bold; float: left; margin-left: 10px;">TABLA DE CONTENIDO</span>
				<div class="dropdown-content" id="dropdownContent"></div>
			</div>
		</a>
		<div id="contenido">
			<h5>LUKS &amp; dm-crypt [Encriptación de Discos y Particiones]</h5>
			<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
			<a href="#INTRO" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Intro</p></a>
			<a href="#componentes" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Componentes de LUKS</p></a>
			<a href="#cryptsetup" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Encriptar una partición con LUKS</p></a>
			<a href="#luksformat" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Formatos LUKS</p></a>
			<a href="#benchmark" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Benchmark Ciphers</p></a>
			<a href="#luksDump" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Volcar información de una partición LUKS</p></a>
			<a href="#passphrases" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Gestión de Passphrases</p></a>
			<a href="#xfs" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Mapear y Formatear la partición encriptada</p></a>
			<a href="#crypttab" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: 16px;">☰ Montar la partición LUKS [crypttab &amp; fstab]</p></a>
		</div>
	</div><!-- END TABBAR -->

	<div class="content-body">
		<div id="main" style="position: sticky; top: 0;">
			<button class="openbtn" onclick="toggleNav()">☰</button>  
		</div><br>
		<div id="mySidebar" class="sidebar" style="position: sticky; top: 0; margin-top: -24px; display: none;">
			<a href="javascript:void(0)" class="closebtn" onclick="toggleNav()">×</a>
			<span style="font-size: 25px; color: rgb(255, 0, 255, 1);"><b>&nbsp;✎</b></span><span style="font-size: 25px; color: white;"> <b>Notas</b></span>
			<hr style="color: #AD009E;">
			<a><span style="color: #E5D400;">luksFormat</span><span class="spanx">: Configura el encabezado del dispositivo LUKS y establece la passphrase con las opciones criptográficas deseadas</span></a>
			<a><span style="color: #E5D400;">luksDump</span><span class="spanx">: Muestra información sobre la clave maestra, tipo de cifrado, checksum y Keyslots de la partición LUKS</span></a>
			<a><span style="color: #E5D400;">luksAddKey</span><span class="spanx">: Añade una clave a dispositivos LUKS</span></a>
			<a><span style="color: #E5D400;">open</span><span class="spanx">: Libera el dispositivo LUKS asignandole un nombre mapeado</span></a>
			<a><span style="color: #E5D400;">shred</span><span class="spanx">: Sobrescribe un archivo o dispositivo con datos aleatorios</span></a>
			<a><span style="color: #E5D400;">luksUUID</span><span class="spanx">: Imprime el UUID del dispositivo LUKS</span></a>
			<a><span style="color: #E5D400;">crypttab</span><span class="spanx">: Información estática sobre filesystems encriptados</span></a>
		</div>
		<div class="container">
			<div class="row">
				<main class="col-md-8" style="margin-left: auto; margin-right: auto;">
					<article class="post post-1">
						<header  class="entry-header">
							<h1 class="blh1">LUKS &amp; dm-crypt</h1>
							<h2 class="blh2">ENCRIPTAR D1SC0$ Y P4RT1C10N3$</h2>
						</header>
						<div class="entry-content clearfix">
							<section style="margin-top: 50px;" id="INTRO">
								<!--- INTRO --->
								<div class="centext">
									<span>Se trata de una <b>especificación</b> de <b>cifrado</b> de discos totalmente <b>independiente</b> de la plataforma sobre la que trabaja.</span><br><br>
									<span>Este artilugio se utiliza para <b>cifrar dispositivos</b> de bloque y permite la especificación de <b>algoritmos</b> de <b>cifrado</b>, <b>modos</b> de <b>cifrado</b>, <b>passphrases</b>, <b>vectores</b> de <b>inicialización</b> [<b>IV´s</b>]</span>
								</div><!--- ./INTRO --->
							</section>

							<section style="margin-top: 130px;" id="componentes">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">COMPONENTES DE LUKS</span>
								</div><p></p>
								
								<div class="leftl">
									<span><b><a style="color: #AD009E;">⦾</a> Device Mapper {DM}:</b> Este FrameWork se encarga de mapear dispositivos de bloque dentro de otros, haciendo que el último se comunique con un dispositivo físico.</span><p></p>
									<span><b><a style="color: #AD009E;">⦾</a> DM-Crypt:</b> Es un subsistema de cifrado de discos {Integrado en DM} y se encarga de cifrar discos físicos o dispositivos de bloques virtuales de forma transparente.</span><p></p>
									<span><b><a style="color: #AD009E;">⦾</a> cryptsetup:</b> Es la herramienta en línea de comandos encargada de interactuar con dm-crypt simple para crear, gestionar y acceder a dispositivos cifrados. Admite diferentes modos de cifrado que dependen de los módulos del Kernel de Linux.</span>
								</div><br><br>
								
								<div class="leftl">
									<span>El método más sencillo para cifrar discos y particiones se da durante la instalación del S.O.</span><p></p>
								</div>
									<a href="/blog/hardening/img/lukslvm.jpg" target="_blank"><img src="/blog/hardening/img/lukslvm.jpg" class="imgamx" width="100%"></a>
							</section>
							<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>

							<section style="margin-top: 130px;" id="cryptsetup">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">ENCRIPTAR UNA PARTICIÓN CON LUKS</span>
								</div><p></p>
								
								<div class="leftl">
									<span>Parto de un disco <b>sdb</b> con una partición <b>/dev/sdb1</b></span>
								</div><p></p>

								<div id="long-terminal">   
									<!-- Terminal Bar -->       
									<section id="terminal__bar">          
										<div id="bar__buttons">            
											<button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
											<button class="bar__button">&#9472;</button>                
											<button class="bar__button">&#9723;</button>          
										</div>
									</section>        
									<!-- Terminal Body -->
									<section style="background-color: #22363f;" id="hdterminal__body">
											<div id="terminal__prompt">
												<span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
												<span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF5FFA;"> luksFormat</a> /dev/sdb1</b></span>
											</div><p></p>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>WARNING!</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>========</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>This will overwrite data on /dev/sdb1 irrevocably.</b>&nbsp;</span>
										  </div><br>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>Are you sure? (Type uppercase yes): <a style="color: #FF5FFA;">YES</a></b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>Enter passphrase for /dev/sdb1:</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>Verify passphrase:</b></span>
										  </div>
									  </section>
								</div><br><br>
								
								<div class="leftl">
									<span><b><a style="color: #AD009E;">⦾</a> luksFormat:</b> Configura el encabezado del dispositivo LUKS y establece la passphrase con las opciones criptográficas deseadas.</span><br>
									<span>El valor por defecto actual en las fuentes distribuidas es <b>aes-cbc-essiv:sha256</b> para <b>dm-crypt simple</b> y <b>aes-xts-plain64</b> para LUKS.</span>
								</div>
								</section>
								<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
								
								<section style="margin-top: 130px;" id="luksformat">
									<div class="centext">
										<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">FORMATOS LUKS</span>
									</div><br><p></p>
								
									<div class="leftl">
										<span><b><a style="color: #AD009E;">⦾</a> LUKS:</b> aes-xts-plain64, Key: 256 bits, LUKS header hashing: sha256, RNG: /dev/urandom</span><p></p>
										<span><b><a style="color: #AD009E;">⦾</a> LUKS1:</b> pbkdf2, iteration time: 2000 (ms)</span><p></p>
										<span><b><a style="color: #AD009E;">⦾</a> LUKS2:</b> Formato de metadatos compilado por defecto al usar la opción <b>luksFormat</b> si no se especifican otras opciones. PBKDF por defecto: <b>argon2i</b></span><p></p>
										<span><b><a style="color: #AD009E;">⦾</a> plain:</b> aes-cbc-essiv:sha256, Key: 256 bits, Password hashing: ripemd160</span><p></p>
										<span><b><a style="color: #AD009E;">⦾</a> tcrypt:</b> Modo de compatibilidad con <b>TrueCrypt</b></span><p></p>
									</div>
								</section>
							
							<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
								
								<section style="margin-top: 130px;" id="benchmark">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">BENCHMARK CIPHERS</span>
								</div><p></p>
								
								<div class="leftl">
									<span>La opción <b>benchmark</b> de <b>cryptsetup</b> imprime en pantalla los <b>algoritmos</b> y <b>cifrados de referencia</b> que se cargan en tiempo de ejecución.</span>
								</div><p></p>
								
								
								
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #AD009E;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--user"><b><a style="color: #AD009E;">☰</a>&nbsp;</b></span>
											<span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF8EF6;"> benchmark</a></b>&nbsp;</span>
										  </div>
									  </section>
								</div><p></p>
								
								<a href="/blog/hardening/img/benchmark1.png" target="_blank"><img src="/blog/hardening/img/benchmark1.png" class="imgmax" width="100%"></a><p></p>
								<a href="/blog/hardening/img/benchmark2.png" target="_blank"><img src="/blog/hardening/img/benchmark2.png" class="imgmax" width="88%"></a>
								</section>
									<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
								
								<section style="margin-top: 130px;" id="luksDump">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">VOLCAR INFORMACIÓN DE UNA PARTICIÓN LUKS</span>
								</div>
								
								<div style="margin-top: 10px;" id="terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											<span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF8EF6;"> luksDump</a> /dev/sdb1</b>&nbsp;</span>
										  </div>
									  </section>
								</div>
								
								<div style="margin-top: 10px;" class="leftl">
									<span><b><a style="color: #AD009E;">⦾</a> luksDump:</b> Muestra información sobre la clave maestra, tipo de cifrado, checksum y Keyslots de la partición LUKS</span>
								</div>
									<a href="/blog/hardening/img/luksDump1.png" target="_blank"><img src="/blog/hardening/img/luksDump1.png" width="80%"></a><p></p>
									<a href="/blog/hardening/img/luksDump2.png" target="_blank"><img src="/blog/hardening/img/luksDump2.png" width="80%"></a><br><br>
								
									<div style="margin-top: 30px;" class="leftl">
										<span>Un <b>Keyslot</b> almacena el <b>hash</b> de la <b>passphrase</b> configurada y LUKS admite hasta <b>8</b> Keyslots [<b>0-7</b>]</span><p></p>
										<span>Esto significa que diferentes personas podrían desbloquear el disco para acceder a él, con <b>passphrases</b> distintas e <b>independientes</b>.</span>
									</div>
								</section>
							
							<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
								
								<section style="margin-top: 130px;" id="passphrases">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">GESTIÓN DE PASSPHRASES</span>
								</div>
								
								<div style="margin-top: 10px;" class="leftl">
									<span>Para añadir una nueva key, será necesario ingresar una passphrase válida configurada anteriormente.</span>
								</div>
								
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											<span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF8EF6;"> luksAddKey</a> /dev/sdb1</b></span>
										  </div><p></p>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>Enter any existing passphrase:</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>Enter new passphrase for key slot:</b>&nbsp;</span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>Verify passphrase:</b></span>
										  </div>
									  </section>
								</div><br><br>
								
								<div class="leftl">
									<span><b><a style="color: #B100A6;">⦾</a> luksAddKey:</b> Añade una clave a dispositivos LUKS</span>
								</div><p></p><br>
								
								<div class="leftl">
									<span>Desde este momento la partición <b>/dev/sdb1</b> puede ser desbloqueada con <b>2 claves</b> distintas, ubicadas en los key slots <b>0</b> y <b>1</b></span>
								</div><p></p>
								
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									<section style="background-color: #22363f;" id="hdterminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											<span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF8EF6;"> luksDump</a> /dev/sdb1</b>&nbsp;</span>
										  </div>
									</section></div><br><p></p>
								
								<img src="/blog/hardening/img/keyslot0.png" width="80%" class="imgmax"><p></p>
								<img src="/blog/hardening/img/keyslot1.png" class="imgmax" width="80%">
								</section>
									<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
								
								<section style="margin-top: 130px;" id="xfs">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">MAPEAR Y FORMATEAR LA PARTICIÓN ENCRIPTADA</span>
								</div>
								
								<div style="margin-top: 10px;" class="leftl">
									<span><b><a style="color: #B100A6;">⦾</a> open: </b>Libera el dispositivo LUKS asignandole un nombre mapeado o mapping name {En este caso lo llamo <b>lvcrypt</b>}</span>
								</div><p></p>
								
								<div id="terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF8EF6;"> open</a> /dev/sdb1 <a style="color: #FF8EF6;">lvcrypt</a></b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>Enter passphrase for /dev/sdb1:</b></span>
										  </div><p></p>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>ls -l<a style="color: #FF8EF6;"> /dev/mapper</a></b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>lrwxrwxrwx 1 root root 7 Apr 11 23:24 <a style="color: #FF5FFA;">lvcrypt</a> -> ../dm-5</b>&nbsp;</span>
										  </div>
									  </section>
								</div><br>
								
									<div style="margin-top: 10px;" class="leftl">
										<span><b><a style="color: #B100A6;">⦾</a> shred</b> Sobrescribe un archivo o dispositivo con datos aleatorios para ocultar su contenido y hacerlo más ilegible, lo que dificultaría la labor de desencriptación o lectura por parte de personas ajenas.</span>
									</div>
									
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											<span id="terminal__prompt--bling"><b>shred<a style="color: #FF8EF6;"> -v -n1</a> /dev/mapper/lvcrypt</b>&nbsp;</span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...</b>&nbsp;</span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...342MiB/8.0GiB 4%</b>&nbsp;</span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...654MiB/8.0GiB 8%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...990MiB/8.0GiB 12%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...1.2GiB/8.0GiB 15%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...1.6GiB/8.0GiB 20%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...1.9GiB/8.0GiB 24%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...2.1GiB/8.0GiB 27%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...2.5GiB/8.0GiB 31%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...2.8GiB/8.0GiB 36%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...3.2GiB/8.0GiB 40%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...3.5GiB/8.0GiB 44%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...3.9GiB/8.0GiB 49%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...4.2GiB/8.0GiB 53%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...4.6GiB/8.0GiB 58%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...4.9GiB/8.0GiB 62%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...5.3GiB/8.0GiB 66%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...5.6GiB/8.0GiB 71%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...6.0GiB/8.0GiB 75%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...6.3GiB/8.0GiB 80%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...6.7GiB/8.0GiB 84%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...6.7GiB/8.0GiB 84%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...7.0GiB/8.0GiB 88%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...7.4GiB/8.0GiB 93%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...7.7GiB/8.0GiB 97%</b></span>
										  </div>
										  
										  <div style="margin-left: 1px;" id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b>shred: /dev/mapper/lvcrypt: pass 1/1 (random)...8.0GiB/8.0GiB 100%</b>&nbsp;</span>
										  </div>
									  </section>
								</div>
								
								<div style="margin-top: 88px;" class="leftl">
									<span><b><a style="color: #FF5FFA;">⦾</a> FORMATEAR LA PARTICIÓN EN XFS</b></span>
								</div><p></p>
								
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										  <div id="terminal__prompt">
											<span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											<span id="terminal__prompt--bling"><b>mkfs.xfs<a style="color: #FF8EF6;"> /dev/mapper/lvcrypt</a></b>&nbsp;</span>
										  </div>
									</section>
								</div>
								
								<img src="/blog/hardening/img/xfs.png" class="imgmax" width="100%">
								</section>
									<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>

								<section style="margin-top: 130px;" id="crypttab">
								<div class="centext">
								<a style="font-size: 19px; color: rgb(194, 0, 194);">☰ </a><span class="purple-bg" style="font-size: 19px;">MONTAR LA PARTICIÓN LUKS [CRYPTTAB &amp; FSTAB]</span>
								</div>
								
								<div style="margin-top: 28px;" class="leftl">
									<span>Ahora que la partición está liberada y mapeada, es posible montarla.</span>
								</div>
								
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>mkdir<a style="color: #FF8EF6;"> /mnt/luks</a></b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>mount<a style="color: #FF8EF6;"> /dev/mapper/lvcrypt</a> /mnt/luks</b></span>
										  </div><br>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>df <a style="color: #FF8EF6;"> -Th</a> /mnt/luks</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lvcrypt xfs 8.0G 41M 8.0G 1% /mnt/luks</b>&nbsp;</span>
										  </div>
									</section>
								</div><br>
								
								<div style="margin-bottom: 5px;" class="leftl">
									<span>Para que la partición o el dispositivo LUKS se monte automáticamente tras reiniciar o iniiciar el sistema, entran en juego <b>crypttab</b> y <b>fstab.</b></span><p></p><br>
									<span>El primer paso es localizar el <b>luksUUID</b> de la <b>partición LUKS</b> para configurar el fichero <b>/etc/crypttab</b></span>
								</div>
								
								<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>cryptsetup<a style="color: #FF8EF6;"> luksUUID</a> /dev/sdb1</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>3968fe2a-98e9-4ecb-8ccb-81af2f6d7f77</b></span>
										  </div><br>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>vi<a style="color: #FF8EF6;"> /etc/crypttab</a></b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b># &lt;target name&gt;	&lt;source device&gt; &lt;key file&gt; &lt;options&gt;</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>lvcrypt UUID=3968fe2a-98e9-4ecb-8ccb-81af2f6d7f77 <a style="color: #FF8EF6;">none</a> luks</b>&nbsp;</span>
										  </div>
									</section>
								</div>
								
								<div style="margin-top: 25px;" class="leftl">
									<span><b><a style="color: #B100A6 ;">⦾</a> luksUUID: </b>Imprime el UUID del dispositivo LUKS.</span><br>
									<span><b><a style="color: #B100A6 ;">⦾</a> none: </b>Esta opción le indica a crypttab que la passphrase para descifrar el dispositivo al inicio, no se va a leer desde un fichero. En su lugar, la solicitará durante el arranque del sistema.</span><br>
									<span><b><a style="color: #B100A6 ;">⦾</a> luks: </b>Fuerza el modo LUKS. Cuando se utiliza este modo, las opciones <b>cipher=</b>, <b>hash=</b>, <b>size=</b> son ignoradas ya que son proporcionadas por la cabecera LUKS en el dispositivo: </span>
								</div>
							
							<div style="margin-top: 65px;" class="leftl">
								<span>Ahora se configura el dispositivo mapeado {<b>DM</b>} en <b>/etc/fstab</b>. Para ello localizamos el <b>UUID</b> del <b>DM</b></span>
							</div>
							
							<div id="long-terminal">   
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button style="background: #FF5FFA;" class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section style="background-color: #22363f;" id="hdterminal__body">
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>blkid<a style="color: #FF8EF6;"> /dev/mapper/lvcrypt</a></b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lvcrypt: UUID="98313a16-4952-473c-bfbe-5be99209dea7" TYPE="xfs"</b></span>
										  </div><br>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--user"><b><a style="color: #FF5FFA;">☰</a>&nbsp;</b></span>
											  <span id="terminal__prompt--bling"><b>vi<a style="color: #FF8EF6;"> /etc/fstab</a></b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lithium--vg-root / ext4 errors=remount-ro 0 1</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>UUID=a39b4ddf-34e7-446b-a77a-1cc14780b1bf /boot ext2 defaults 0 2</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lithium--vg-home /home ext4 defaults 0 2</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lithium--vg-tmp /tmp ext4 defaults 0 2</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lithium--vg-var /var ext4 defaults 0 2</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/mapper/lithium--vg-swap_1 none swap sw 0 0</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>/dev/sr0 /media/cdrom0 udf,iso9660 user,noauto 0 0</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											  <span style="margin-left: 1px;" id="terminal__prompt--bling"><b>UUID="98313a16-4952-473c-bfbe-5be99209dea7" /mnt/luks xfs defaults 0 0</b></span>
										  </div>
									</section>
								</div>
								
								<div style="margin-top: 80px;" class="leftl">
									<span>Al reiniciar el sistema, <b>crypttab</b> solicitará la <b>passphrase</b> para descifrar y montar el dispositivo</span>
								</div>
									<a href="/blog/hardening/img/lvcryptpwd.png" target="_blank"><img src="/blog/hardening/img/lvcryptpwd.png" class="imgmax" width="105%"></a>
								</section>
							</div>
						</article>
					</main>
				</div>
			</div>
		</div>

		<footer id="site-footer">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div class="copyright">
						<a href="#"><img src="/blog/img/skull.png" class="icomax" style="width: 10%"></a>
						</div>
					</div>
				</div>
			</div>
		</footer>
		<a href="#" id="scrollToTopButtonPurple"><i class="fas fa-arrow-up"></i></a>
<script>
function toggleNav() {
  var sidebar = document.getElementById("mySidebar");
  var sidebarDisplay = window.getComputedStyle(sidebar).display;

  if (sidebarDisplay === "none") {
    sidebar.style.display = "block";
    sidebar.style.width = "200px";
  } else {
    sidebar.style.display = "none";
  }
}
</script>
</body>
</html>
